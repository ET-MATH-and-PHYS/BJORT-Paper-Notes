\section{Linear Approximations}


In this section we define the linear approximation of a functor $F:\mathcal{B}\rightarrow \cat{Ch}(\mathcal{A})$ as a functor $D_1(F)$ in $\cat{AbCat}_{\cat{Ch}}$. This construction will coincie, up to homotopy, with the homotopy fiber of the map $q_1:P_1(F)\to P_0(F)$. All of the properties we will describe for $D_1(F)$ are developed only up to \rd{natural} chain homotopy equivalence.

\begin{defn}[label=defn:linearization]
    The \textbf{linearization} of $F:\mathcal{B}\rightarrow \cat{Ch}(\mathcal{A})$ is the functor $D_1(F):\mathcal{B}\rightarrow \mathcal{A}$ given as the totalization of the explicit chain complex of chain complexes $(D_1(F)_\bullet,\partial_\bullet)$ where:
    %%
    \begin{equation*}
        D_1(F)_k := \left\{\begin{array}{cc} C_2^{\times k}(F) & k \geq 1 \\ \text{cr}_1(F) & k = 0 \\ 0 & \text{else} \end{array}\right.
    \end{equation*}
    %%
    and the differential $\partial_1:D_1(F)_1\rightarrow D_1(F)_0$ is given by $\rho_1$, while for $k \geq 2$, $\partial_k:D_1(F)_k\rightarrow D_1(F)_{k-1}$ is given by the alternating sum $\sum_{i=0}^{k-1}(-1)^iC_2^{\times i}\epsilon_{C_2^{\times (k-1-i)}}$. Note $\rho_1 = \epsilon$ since $C_2(F) \cong C_2(\text{cr}_1(F))$.
\end{defn}

Recall that $P_0(F)$ is naturally chain homotopy equivalent to $F(0)$. Using this model the induced map $q_1:P_1(F)\to P_0(F)\to F(0)$ is a degree-wise epimorphism, and hence a fibration in the standard model structure on non-negatively graded chain complexes.

\begin{proof}[Proof of Epimorphism]
    Note by our explicit construction of $q_1$, $q_1\circ p_1:F\to F(0)$ is exactly the projection for the isomorphism $F \cong F(0)\oplus \text{cr}_1(F)$. But this is epi as a map of chain complexes in each degree, so $q_1$ must also be epi.
\end{proof}

This implies that the kernel of $q_1$ is a model of the homotopy fiber, when this structure makes sense. Note that our definition of $D_1(F)$ coincides with $P_1(\text{cr}_1(F))$ due to Lemma \ref{lem:idempotCr1}, which is exactly the kernel of $q_1:P_1(F)\to F(0)$. 

To start understanding the linear approximation we consider an example:

\begin{eg}{}
    We consider the affine functor $F(X) = A\oplus X$. Recall $\text{cr}_2(F) \cong 0$ and $\text{cr}_1(F) \cong \id$. This implies that $D_1(F)$ is chain homotopy equivalent to $\id$ in degree $0$.
\end{eg}

We begin by inspecting properties of $D_1$. First we obtain immediate results since $D_1\cong P_1\circ \text{cr}_1$.

\begin{prop}[label=prop:D1Exact]
    \begin{itemize}
        \item[(i)] $D_1:\text{Fun}(\mathcal{B},\cat{Ch}(\mathcal{A}))\to \text{Fun}(\mathcal{B},\cat{Ch}(\mathcal{A}))$ is exact
        \item[(ii)] $D_1$ preserves (natural) chain homotopies, chain homotopy equivalences, and contractibility.
    \end{itemize}
\end{prop}
\begin{proof}
    These results follow from Propositions~\ref{prop:exactPol} and~\ref{prop:exactCross} using the isomorphism $D_1\cong P_1\circ \text{cr}_1$.
\end{proof}

Relaxing some of our previous constraints to the level of \rd{natural} chain homotopy equivalence, we define what it means for a functor to be linear.

\begin{defn}[label=defn:linear]
    A functor $F:\mathcal{B}\to \cat{Ch}(\mathcal{A})$ is said to be \textbf{linear} if it is degree one and weakly reduced, so $F(0)$ is naturally contractible.
\end{defn}

This definition is equivalent to a characterization in terms of finite direct sums. In order to establish this equivalence we must first prove results on how direct sums interact with natural chain homotopy equivalence. These results are a generalization of Lemma~\ref{lem:biprod}.

\begin{lem}[label=lem:oplusPres]
    Let $F,G,H:\mathcal{B}\to \cat{Ch}(\mathcal{A})$ be functors and let $f,g:F\Rightarrow G$ be chain homotopic maps. Then $f\oplus 1_H$ is chain homotopic to $g\oplus 1_H$.
\end{lem}
\begin{proof}
    Note that under the isomorphism $\text{Fun}^{\cat{Ch}}:\cat{Ch}(\text{Fun}(\mathcal{B},\mathcal{A}))\to \text{Fun}(\mathcal{B},\cat{Ch}(\mathcal{A}))$, it is sufficient to show for $F_\bullet,G_\bullet,H_\bullet \in \cat{Ch}(\text{Fun}(\mathcal{B},\mathcal{A}))$, with $f,g:F_\bullet\Rightarrow G_\bullet$, and let for each $n \in \Z$, $s_n:F_n\Rightarrow G_{n+1}$ denote the component natural transformations for the homotopy. Note that $-\oplus H_\bullet:\cat{Ch}(\text{Fun}(\mathcal{B},\mathcal{A}))\to \cat{Ch}(\text{Fun}(\mathcal{B},\mathcal{A}))$ is a functor. We consider $s_n\oplus 0:F_n\oplus H_n\Rightarrow G_{n+1}\oplus H_{n+1}$. Then 
    %%
    \begin{align*}
        (\partial_{n+1}^G\oplus \partial_{n+1}^H)\circ (s_n\oplus 0)+(s_{n-1}\oplus 0)\circ (\partial_n^F\oplus \partial_n^H) &= (\partial_{n+1}^G\circ s_n+s_{n-1}\circ \partial_n^F)\oplus 0  \\
        &= (f_n-g_n)\oplus (1_{H_n}-1_{H_n}) \\
        &= f_n\oplus 1_{H_n}-g_n\oplus 1_{H_n}
    \end{align*}
    %%
    as desired.
\end{proof}

We also have the converse result.

\begin{lem}[label=lem:homotopCancel]
    Let $F,G,H:\mathcal{B}\to \cat{Ch}(\mathcal{A})$ be functors and let $f,g:F\Rightarrow G$ be maps such that $f\oplus 1_H$ and $g\oplus 1_H$ are chain homotopic maps. Then $f$ is chain homotopic to $g$.
\end{lem}
\begin{proof}
    Once again we pass to $F_\bullet,G_\bullet,H_\bullet\in \cat{Ch}(\text{Fun}(\mathcal{B},\mathcal{A}))$ with $f,g:F_\bullet\Rightarrow G_\bullet$. Let 
    %%
    \begin{equation*}
        \begin{pmatrix} s_n^{1,1} & s_n^{1,2} \\ s_n^{2,1} & s_n^{2,2} \end{pmatrix}:F_n\oplus H_n\to G_{n+1}\oplus H_{n+1}
    \end{equation*}
    %%
    be the homotopy witnessing $f\oplus 1_H$ homotopic to $g\oplus 1_H$. Then the homotopy condition takes the form
    %%
    \begin{equation*}
        \begin{pmatrix} \partial_{n+1}^Gs_n^{1,1}+s_{n-1}^{1,1}\partial_n^G & \partial_{n+1}^Gs_n^{1,2}+s_{n-1}^{1,2}\partial_n^H \\ \partial_{n+1}^Hs_n^{2,1}+s_{n-1}^{2,1}\partial_n^G & \partial_{n+1}^Hs_n^{2,2}+s_{n-1}^{2,2}\partial_n^H \end{pmatrix} = \begin{pmatrix} f_n-g_n & 0 \\ 0 & 0 \end{pmatrix}
    \end{equation*}
    %%
    It follows that $s_n^{1,1}:F_n\to G_{n+1}$ forms a homotopy from $f$ to $g$.
\end{proof}

As an immediate corollary of Lemma~\ref{lem:oplusPres} and Lemma~\ref{lem:homotopCancel} we have that chain homotopy equivalences are preserved by direct sum and satisfy the cancellative property.

We can now prove the previously asserted equivalence.

\begin{prop}[label=prop:linearEquiv]
    A functor $F:\mathcal{B}\to \cat{Ch}(\mathcal{A})$ is linear if and only if the natural map
    %%
    \begin{equation*}
        D_1(F)(X)\oplus D_1(F)(Y)\hookrightarrow D_1(F)(X\oplus Y)
    \end{equation*}
    %%
    is a natural chain homotopy equivalence.
\end{prop}
\begin{proof}
    First suppose $F:\mathcal{B}\to \cat{Ch}(\mathcal{A})$ is linear. Then we have that $\text{cr}_2(F)\simeq_{\cat{Ch}}0$ and $F(0)\simeq_{\cat{Ch}}0$. Recall from the inductive definition of the cross effect that 
    %%
    \begin{equation*}
        \text{cr}_1(F)(X\oplus Y) \cong \text{cr}_1(F)(X)\oplus \text{cr}_1(F)(Y)\oplus \text{cr}_2(F)(X,Y)
    \end{equation*}
    %%
    naturally in $X$ and $Y$. Then by Lemma~\ref{lem:oplusPres} we have that \[\text{cr}_1(F)(X)\oplus \text{cr}_1(F)(Y)\oplus \text{cr}_2(F)(X,Y)\simeq_{\cat{Ch}}\text{cr}_1(F)(X)\oplus \text{cr}_1(F)(Y)\oplus 0 \cong \text{cr}_1(F)(X)\oplus \text{cr}_1(F)(Y)\] 
    so $\text{cr}_1(F)$ preserves direct sums up to natural chain homotopy equivalence. Then since $F(0)\simeq_{\cat{Ch}}0$ and $F\cong \text{cr}_1(F)\oplus F(0)$, it follows that $F$ also preserves direct sums up to natural chain homotopy equivalence.

    \vspace{10pt}

    Conversely, if $F$ preserves direct sums up to natural chain homotopy equivalence we have the identity
    %%
    \begin{equation*}
        F(0)\cong F(0\oplus 0)\simeq_{\cat{Ch}}F(0)\oplus F(0)
    \end{equation*}
    %%
    so by Lemma~\ref{lem:homotopCancel} it follows that $F(0) \simeq_{\cat{Ch}} 0$. Similarly, using the inductive formula for $\text{cr}_2(F)$ and Lemma~\ref{lem:homotopCancel} we have that $\text{cr}_2(F)$ is naturally contractible, so $F$ is degree 1.
\end{proof}

Note that since $D_1$ is an exact functor it is linear in the sense that it preserves the zero object and direct sums of functors up to natural isomorphism.


The next main result we wish to show is that $D_1$ preserves composition up to \rd{naturally} chain homotopy, upgrading the original pointwise chain homotopy results in~\cite{BJORT}. The primary work and lemmas for this result are contained in Section~\ref{sec:Lotswork}. In particular, we will prove the following result in Section~\ref{sec:Lotswork}.

\begin{prop}[label=prop:5.7]
    If $F:\mathcal{B}\to \cat{Ch}(\mathcal{A})$ and $G:\mathcal{C}\to \cat{Ch}(\mathcal{B})$ are composible functors in $\cat{AbCat}_{\cat{Ch}}$ such that $G$ is reduced, Then
    %%
    \begin{equation*}
        D_1(F\lhd G) \simeq_{\cat{Ch}} D_1(F)\lhd D_1(G)
    \end{equation*}
    %%
\end{prop}

In this section we will extend this result to non-reduced $G$. First, by Lemma~\ref{lem:idempotCr1} we have that $\text{cr}_1(\text{cr}_1(F))\cong \text{cr}_1(F)$, so as $D_1(F) \cong P_1(\text{cr}_1(F))$ and post-composition preserves natural isomorphisms we obtain that $D_1(F) \cong D_1(\text{cr}_1(F))$. Before extending the proposition we first prove some preliminary results on the relationship between the direct sum operation on functors and our composition, $\lhd$, in $\cat{AbCat}_{\cat{Ch}}$. 

\begin{lem}[label=lem:compDirSum]
    Let $F,G:\mathcal{B}\to \cat{Ch}(\mathcal{A})$ and $H,K:\mathcal{C}\to \cat{Ch}(\mathcal{B})$. Then there is a natural isomorphism
    %%
    \begin{equation*}
        (F\oplus G)\lhd (H\oplus K) \cong (F\lhd H)\oplus (F\lhd K)\oplus (G\lhd H)\oplus (G\lhd K)
    \end{equation*}
    %%
\end{lem}
\begin{proof}
    To prove the claim we proceed in steps. First, we show that
    %%
    \begin{equation*}
        F\lhd (H\oplus K) \cong (F\lhd H)\oplus (F\lhd K)
    \end{equation*}
    %%
    Observe that by definition 
    %%
    \begin{equation*}
        F\lhd (H\oplus K) = N_\mathcal{A}\Delta_\mathcal{A}(\Gamma_\mathcal{A})_*F_*\Gamma_\mathcal{B}(H\oplus K)
    \end{equation*}
    %%
    Since isomorphisms and $\Delta_\mathcal{A}$ preserve limits, and direct sums of functors in abelian categories are given pointwise, it follows that
    %%
    \begin{equation*}
        N_\mathcal{A}\Delta_\mathcal{A}(\Gamma_\mathcal{A})_*F_*\Gamma_\mathcal{B}(H\oplus K) \cong (N_\mathcal{A}\Delta_\mathcal{A}(\Gamma_\mathcal{A})_*F_*\Gamma_\mathcal{B}H)\oplus (N_\mathcal{A}\Delta_\mathcal{A}(\Gamma_\mathcal{A})_*F_*\Gamma_\mathcal{B}K)
    \end{equation*}
    %%
    and so 
    %%
    \begin{equation*}
        F\lhd (H\oplus K) \cong (F\lhd H)\oplus (F\lhd K)
    \end{equation*}
    %%

    \vspace{10pt}

    Next we show 
    %%
    \begin{equation*}
        (F\oplus G)\lhd H \cong (F\lhd H)\oplus (G\lhd H)
    \end{equation*}
    %%
    First, note that since $\Gamma$ preserves direct sums, $\Gamma_\mathcal{A}\circ (F\oplus G)\cong (\Gamma_\mathcal{A}\circ F)\oplus (\Gamma_\mathcal{A}\circ G)$. Then by definition of the direct sum of functors
    %%
    \begin{equation*}
        ((\Gamma_\mathcal{A}\circ F)\oplus (\Gamma_\mathcal{A}\circ G))_*\Gamma_\mathcal{B}H = (\Gamma_\mathcal{A}\circ F)_*\Gamma_\mathcal{B}H\oplus (\Gamma_\mathcal{A}\circ G)_*\Gamma_\mathcal{B}H
    \end{equation*}
    %%
    Since $\Delta_\mathcal{A}$ and $N_\mathcal{A}$ preserve limits, we have that 
    %%
    \begin{equation*}
        (F\oplus G)\lhd H \cong (F\lhd H)\oplus (G\lhd H)
    \end{equation*}
    %%
    as desired.
\end{proof}


In order to extend the proposition we require one additional result.

\begin{lem}[label=lem:compGen]
    If $F:\mathcal{B}\to \cat{Ch}(\mathcal{A})$ and $G:\mathcal{C}\to \cat{Ch}(\mathcal{B})$ are composible functors, then 
    %%
    \begin{equation*}
        \text{cr}_1(F\lhd G)(X) \cong (\text{cr}_1(F)\lhd \text{cr}_1(G))(X)\oplus (\text{cr}_2(F)\lhd (G(0)\oplus \text{cr}_1(G)(X)))
    \end{equation*}
    %%
\end{lem}
\begin{proof}
    First, observe that $\text{cr}_1(F\lhd G)\oplus (F\lhd G)(0) \cong F\lhd G$ by construction of the cross-effect. Next, using the isomorphism again but now on $F$ and $G$ individually,
    %%
    \begin{equation*}
        F\lhd G \cong F\lhd (G(0)\oplus \text{cr}_1(G)) \cong (F(0)\oplus \text{cr}_1(F))\lhd (G(0)\oplus \text{cr}_1(G))
    \end{equation*}
    %%
    
\end{proof}

